<?xml version="1.0" encoding="utf-8" ?>
<local:BaseContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:NoveoNative"
             x:Class="NoveoNative.SettingsPage"
             BackgroundColor="{Binding PageBgColor}"
             NavigationPage.HasNavigationBar="False"
             Shell.NavBarIsVisible="False">

    <Grid RowDefinitions="Auto,*" BackgroundColor="{Binding PageBgColor}">

        <!-- Custom Header -->
        <Border Grid.Row="0" BackgroundColor="{Binding CardBgColor}" Padding="15,10" StrokeThickness="0">
            <Grid ColumnDefinitions="Auto,*">
                <Button Grid.Column="0" Text="â†" BackgroundColor="Transparent" 
                        TextColor="{Binding PageTextColor}" FontSize="24" 
                        Clicked="OnClose" WidthRequest="40" HeightRequest="40"/>
                <Label Grid.Column="1" Text="Settings" FontSize="20" FontAttributes="Bold"
                       TextColor="{Binding PageTextColor}" VerticalOptions="Center" Margin="10,0,0,0"/>
            </Grid>
        </Border>

        <!-- Content -->
        <ScrollView Grid.Row="1" Padding="20">
            <VerticalStackLayout Spacing="20">

                <!-- Avatar Section -->
                <Border BackgroundColor="{Binding CardBgColor}" 
                        StrokeThickness="1" Stroke="{Binding BorderColor}"
                        Padding="20" StrokeShape="RoundRectangle 12">
                    <VerticalStackLayout Spacing="15">
                        <Label Text="Profile Picture" 
                               TextColor="{Binding PageTextColor}" 
                               FontSize="16" FontAttributes="Bold"/>
                        <HorizontalStackLayout Spacing="15">
                            <Border StrokeShape="RoundRectangle 40" 
                                    HeightRequest="80" WidthRequest="80" 
                                    Stroke="{Binding BorderColor}" 
                                    StrokeThickness="2">
                                <Image x:Name="AvatarImage" Aspect="AspectFill" BackgroundColor="{Binding InputBgColor}"/>
                            </Border>
                            <Button Text="Change Avatar" 
                                    Clicked="OnUploadAvatar"
                                    BackgroundColor="#3b82f6"
                                    TextColor="White"
                                    VerticalOptions="Center"/>
                        </HorizontalStackLayout>
                    </VerticalStackLayout>
                </Border>

                <!-- Username Section -->
                <Border BackgroundColor="{Binding CardBgColor}"
                        StrokeThickness="1" Stroke="{Binding BorderColor}"
                        Padding="20" StrokeShape="RoundRectangle 12">
                    <VerticalStackLayout Spacing="10">
                        <Label Text="Username" 
                               TextColor="{Binding PageTextColor}"
                               FontSize="16" FontAttributes="Bold"/>
                        <Border StrokeShape="RoundRectangle 8" 
                                Stroke="{Binding BorderColor}" 
                                Padding="10,5" 
                                BackgroundColor="{Binding InputBgColor}">
                            <Entry x:Name="UsernameEntry" 
                                   BackgroundColor="Transparent"
                                   TextColor="{Binding PageTextColor}"
                                   PlaceholderColor="{Binding PlaceholderColor}"/>
                        </Border>
                        <Button Text="Save Username" 
                                Clicked="OnSaveUsername"
                                BackgroundColor="#3b82f6"
                                TextColor="White"/>
                    </VerticalStackLayout>
                </Border>

                <!-- Theme Toggle -->
                <Border BackgroundColor="{Binding CardBgColor}"
                        StrokeThickness="1" Stroke="{Binding BorderColor}"
                        Padding="20" StrokeShape="RoundRectangle 12">
                    <Grid ColumnDefinitions="*,Auto">
                        <Label Grid.Column="0" Text="Dark Mode" 
                               TextColor="{Binding PageTextColor}"
                               FontSize="16" 
                               VerticalOptions="Center"/>
                        <Switch Grid.Column="1"
                                x:Name="ThemeSwitch"
                                IsToggled="{x:Static local:SettingsManager.IsDarkMode}"
                                Toggled="OnToggleTheme"
                                OnColor="#3b82f6"/>
                    </Grid>
                </Border>

                <!-- Logout Button -->
                <Button Text="Logout" 
                        Clicked="OnLogout"
                        BackgroundColor="#ef4444"
                        TextColor="White"
                        Margin="0,20,0,0"/>
            </VerticalStackLayout>
        </ScrollView>
    </Grid>
</local:BaseContentPage>
